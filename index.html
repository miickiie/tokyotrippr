<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tokyo Trip 8 Days (Interactive)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        body {
            font-family: 'Kanit', sans-serif;
            background-color: #fff1f2; /* Pastel Pink Background */
        }
        .card-shadow {
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1);
        }
        .gradient-header {
            background: linear-gradient(135deg, #fbc2eb 0%, #a6c1ee 100%);
        }
        .pass-badge-metro {
            background: #e0f2fe; color: #0284c7; border: 1px solid #7dd3fc;
        }
        .pass-badge-jr {
            background: #d1fae5; color: #059669; border: 1px solid #6ee7b7;
        }
        .pass-badge-pay {
            background: #f3f4f6; color: #4b5563; border: 1px solid #d1d5db;
        }
        .day-circle {
            width: 2rem;
            height: 2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 9999px;
            font-weight: bold;
            font-size: 0.875rem;
            z-index: 10;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        /* Details Expansion Animation */
        .details-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-out, opacity 0.5s ease-out;
            opacity: 0;
        }
        .details-content.open {
            max-height: 500px; /* Arbitrary large height */
            opacity: 1;
            margin-top: 1rem;
            border-top: 1px dashed #cbd5e1;
            padding-top: 1rem;
        }
        .chevron-icon {
            transition: transform 0.3s;
        }
        .card-open .chevron-icon {
            transform: rotate(180deg);
        }

        /* AI Chat Styles */
        .ai-float-btn {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            z-index: 50;
            animation: pulse-glow 2s infinite;
        }
        @keyframes pulse-glow {
            0% { box-shadow: 0 0 0 0 rgba(167, 139, 250, 0.7); }
            70% { box-shadow: 0 0 0 15px rgba(167, 139, 250, 0); }
            100% { box-shadow: 0 0 0 0 rgba(167, 139, 250, 0); }
        }
        .typing-dot {
            animation: typing 1.4s infinite ease-in-out both;
        }
        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }
        @keyframes typing {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1); }
        }
        @media print {
            .no-print { display: none !important; }
            body { background-color: white; }
            .card-shadow { box-shadow: none; }
            .details-content { max-height: none !important; opacity: 1 !important; display: block !important; }
        }
    </style>
</head>
<body class="py-8 px-4 min-h-screen flex flex-col items-center justify-start relative">

    <div class="w-full max-w-2xl bg-white rounded-3xl overflow-hidden card-shadow relative mb-6">
        
        <!-- Header -->
        <div class="gradient-header p-8 text-center text-white relative">
            <div class="absolute top-4 right-4 no-print flex gap-2">
                <button onclick="generatePackingList()" class="bg-white/30 hover:bg-white/50 text-white px-3 py-1 rounded-full text-sm transition flex items-center gap-1">
                    <i class="fas fa-suitcase"></i> ‚ú® ‡∏à‡∏±‡∏î‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤
                </button>
                <button onclick="window.print()" class="bg-white/30 hover:bg-white/50 text-white px-3 py-1 rounded-full text-sm transition">
                    <i class="fas fa-print"></i> Print
                </button>
            </div>
            <h1 class="text-3xl font-bold drop-shadow-md"><i class="fas fa-snowflake mr-2"></i>TOKYO WINTER</h1>
            <p class="text-lg opacity-90 font-medium mt-1">8 Days 7 Nights (2-9 Feb 2026)</p>
            <div class="mt-4 bg-white/30 backdrop-blur-md rounded-full inline-block px-4 py-1 text-sm font-medium shadow-sm">
                üëÜ ‡πÅ‡∏ï‡∏∞‡∏ó‡∏µ‡πà‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ß‡∏±‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏ß‡∏•‡∏≤
            </div>
        </div>

        <!-- Legend -->
        <div class="bg-white p-4 flex flex-wrap justify-center gap-4 border-b border-gray-100 text-sm">
            <div class="flex items-center font-bold text-blue-500">
                <i class="fas fa-ticket-alt mr-2"></i> Metro Pass
            </div>
            <div class="flex items-center font-bold text-green-600">
                <i class="fas fa-train mr-2"></i> JR Wide Pass
            </div>
            <div class="flex items-center font-bold text-gray-500">
                <i class="fas fa-coins mr-2"></i> ‡∏à‡πà‡∏≤‡∏¢‡∏ï‡∏≤‡∏°‡∏à‡∏£‡∏¥‡∏á/Bus
            </div>
        </div>

        <!-- Timeline Container -->
        <div class="p-6 space-y-8">

            <!-- SECTION 1: METRO DAYS -->
            <div class="relative pl-6 border-l-2 border-dashed border-blue-300">
                <!-- Day 1 -->
                <div class="mb-8 relative">
                    <div class="absolute -left-[2.3rem] top-0 day-circle bg-blue-100 text-blue-600 border-2 border-white">1</div>
                    <div class="bg-blue-50 p-4 rounded-xl border border-blue-100 hover:shadow-md transition-shadow cursor-pointer group" onclick="toggleDetails(this)">
                        <!-- Main Card Content -->
                        <div class="flex justify-between items-start mb-2">
                            <h3 class="font-bold text-gray-800">Mon 02: Hello Tokyo!</h3>
                            <div class="flex items-center gap-2">
                                <span class="pass-badge-metro text-xs px-2 py-1 rounded-full font-bold">Metro 48hr</span>
                                <i class="fas fa-chevron-down text-blue-400 chevron-icon"></i>
                            </div>
                        </div>
                        <p class="text-gray-600 text-sm mb-2">‚úàÔ∏è ‡∏ñ‡∏∂‡∏á 08:15 ‡∏ô. -> ‡∏ù‡∏≤‡∏Å‡∏Ç‡∏≠‡∏á -> ‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß‡∏ß‡∏±‡∏î‡πÄ‡∏Å‡πà‡∏≤</p>
                        <div class="flex gap-2 flex-wrap">
                            <span class="bg-white text-blue-600 text-xs px-2 py-1 rounded shadow-sm border border-blue-50">üìçAsakusa</span>
                            <span class="bg-white text-blue-600 text-xs px-2 py-1 rounded shadow-sm border border-blue-50">üìçSkytree</span>
                            <span class="bg-white text-blue-600 text-xs px-2 py-1 rounded shadow-sm border border-blue-50">üìçUeno</span>
                        </div>

                        <!-- Hidden Details -->
                        <div class="details-content text-sm text-gray-700 space-y-2">
                            <div class="flex gap-3">
                                <span class="font-bold text-blue-500 w-12">08:15</span>
                                <div>‡∏ñ‡∏∂‡∏á‡∏™‡∏ô‡∏≤‡∏°‡∏ö‡∏¥‡∏ô Narita / ‡∏ú‡πà‡∏≤‡∏ô ‡∏ï‡∏°. / ‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏°‡∏∑‡∏≠‡∏á</div>
                            </div>
                            <div class="flex gap-3">
                                <span class="font-bold text-blue-500 w-12">10:30</span>
                                <div>‡∏ù‡∏≤‡∏Å‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤‡∏ó‡∏µ‡πà‡πÇ‡∏£‡∏á‡πÅ‡∏£‡∏° (Ueno/Asakusa Area)</div>
                            </div>
                            <div class="flex gap-3">
                                <span class="font-bold text-blue-500 w-12">‡∏ö‡πà‡∏≤‡∏¢</span>
                                <div><b>Asakusa:</b> ‡πÑ‡∏´‡∏ß‡πâ‡∏û‡∏£‡∏∞‡∏ß‡∏±‡∏î Sensoji, ‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ‡πÇ‡∏Ñ‡∏°‡πÅ‡∏î‡∏á<br>‡πÄ‡∏î‡∏¥‡∏ô‡∏Ç‡πâ‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡πâ‡∏≥ Sumida ‡πÑ‡∏õ‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ‡∏ï‡∏∂‡∏Å Asahi & Skytree</div>
                            </div>
                            <div class="flex gap-3">
                                <span class="font-bold text-blue-500 w-12">‡πÄ‡∏¢‡πá‡∏ô</span>
                                <div><b>Ueno:</b> ‡πÄ‡∏î‡∏¥‡∏ô‡∏ï‡∏•‡∏≤‡∏î Ameyoko ‡∏´‡∏≤‡∏Ç‡∏≠‡∏á‡∏Å‡∏¥‡∏ô‡∏™‡∏ï‡∏£‡∏µ‡∏ó‡∏ü‡∏π‡πâ‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ñ‡∏π‡∏Å</div>
                            </div>
                            <div class="bg-white p-2 rounded border border-blue-100 mt-2 text-xs">
                                <i class="fas fa-train text-blue-500"></i> <b>‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á:</b> Keisei Skyliner (‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏°‡∏∑‡∏≠‡∏á) + Metro (‡πÉ‡∏ô‡πÄ‡∏°‡∏∑‡∏≠‡∏á)
                            </div>
                            <button onclick="event.stopPropagation(); askGemini('‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏°‡∏∑‡πâ‡∏≠‡πÄ‡∏¢‡πá‡∏ô‡πÅ‡∏ñ‡∏ß Ueno ‡∏£‡∏≤‡∏Ñ‡∏≤‡πÑ‡∏°‡πà‡πÅ‡∏û‡∏á ‡∏≠‡∏£‡πà‡∏≠‡∏¢‡πÜ')" class="mt-2 text-blue-500 hover:text-blue-700 text-xs font-bold flex items-center gap-1">
                                <i class="fas fa-sparkles"></i> ‡πÉ‡∏´‡πâ AI ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Day 2 -->
                <div class="relative">
                    <div class="absolute -left-[2.3rem] top-0 day-circle bg-blue-100 text-blue-600 border-2 border-white">2</div>
                    <div class="bg-blue-50 p-4 rounded-xl border border-blue-100 hover:shadow-md transition-shadow cursor-pointer group" onclick="toggleDetails(this)">
                        <div class="flex justify-between items-start mb-2">
                            <h3 class="font-bold text-gray-800">Tue 03: Art & Bay</h3>
                            <div class="flex items-center gap-2">
                                <span class="pass-badge-metro text-xs px-2 py-1 rounded-full font-bold">Metro 48hr</span>
                                <i class="fas fa-chevron-down text-blue-400 chevron-icon"></i>
                            </div>
                        </div>
                        <p class="text-gray-600 text-sm mb-2">üê† ‡∏ï‡∏•‡∏≤‡∏î‡∏õ‡∏•‡∏≤ -> ‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏•‡∏≠‡∏≤‡∏£‡πå‡∏ï -> ‡∏ß‡∏¥‡∏ß‡∏≠‡πà‡∏≤‡∏ß</p>
                        <div class="flex gap-2 flex-wrap">
                            <span class="bg-white text-blue-600 text-xs px-2 py-1 rounded shadow-sm border border-blue-50">üìçTsukiji</span>
                            <span class="bg-white text-blue-600 text-xs px-2 py-1 rounded shadow-sm border border-blue-50">üìçTeamLab</span>
                            <span class="bg-white text-blue-600 text-xs px-2 py-1 rounded shadow-sm border border-blue-50">üìçOdaiba</span>
                        </div>

                        <!-- Hidden Details -->
                        <div class="details-content text-sm text-gray-700 space-y-2">
                            <div class="flex gap-3">
                                <span class="font-bold text-blue-500 w-12">08:00</span>
                                <div><b>Tsukiji Outer Market:</b> ‡∏ó‡∏≤‡∏ô‡∏°‡∏∑‡πâ‡∏≠‡πÄ‡∏ä‡πâ‡∏≤ (‡πÑ‡∏Ç‡πà‡∏´‡∏ß‡∏≤‡∏ô, ‡∏Ç‡πâ‡∏≤‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏õ‡∏•‡∏≤‡∏î‡∏¥‡∏ö)</div>
                            </div>
                            <div class="flex gap-3">
                                <span class="font-bold text-blue-500 w-12">10:30</span>
                                <div><b>TeamLab Planets (Toyosu):</b> ‡πÄ‡∏î‡∏¥‡∏ô‡∏ä‡∏°‡∏®‡∏¥‡∏•‡∏õ‡∏∞‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏• (‡∏ï‡πâ‡∏≠‡∏á‡∏à‡∏≠‡∏á‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤)</div>
                            </div>
                            <div class="flex gap-3">
                                <span class="font-bold text-blue-500 w-12">‡∏ö‡πà‡∏≤‡∏¢</span>
                                <div><b>Odaiba:</b> ‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ Gundam Unicorn, ‡πÄ‡∏ó‡∏û‡∏µ‡πÄ‡∏™‡∏£‡∏µ‡∏†‡∏≤‡∏û, ‡∏´‡πâ‡∏≤‡∏á DiverCity</div>
                            </div>
                            <div class="flex gap-3">
                                <span class="font-bold text-blue-500 w-12">‡πÄ‡∏¢‡πá‡∏ô</span>
                                <div><b>Roppongi Hills:</b> ‡∏ä‡∏°‡πÑ‡∏ü‡∏õ‡∏£‡∏∞‡∏î‡∏±‡∏ö Illumination (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ) ‡∏´‡∏£‡∏∑‡∏≠ City View</div>
                            </div>
                            <div class="bg-white p-2 rounded border border-blue-100 mt-2 text-xs">
                                <i class="fas fa-train text-blue-500"></i> <b>‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á:</b> Metro Pass + Yurikamome (‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏û‡∏¥‡πà‡∏°)
                            </div>
                             <button onclick="event.stopPropagation(); askGemini('‡∏ß‡∏¥‡∏ò‡∏µ‡∏à‡∏≠‡∏á‡∏ï‡∏±‡πã‡∏ß TeamLab Planets ‡∏ó‡∏≥‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£')" class="mt-2 text-blue-500 hover:text-blue-700 text-xs font-bold flex items-center gap-1">
                                <i class="fas fa-sparkles"></i> ‡∏ñ‡∏≤‡∏°‡∏ß‡∏¥‡∏ò‡∏µ‡∏à‡∏≠‡∏á TeamLab
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- SECTION 2: PAY AS YOU GO -->
            <div class="relative pl-6 border-l-2 border-dashed border-gray-300">
                <!-- Day 3 -->
                <div class="relative">
                    <div class="absolute -left-[2.3rem] top-0 day-circle bg-gray-200 text-gray-600 border-2 border-white">3</div>
                    <div class="bg-gray-50 p-4 rounded-xl border border-gray-200 hover:shadow-md transition-shadow cursor-pointer group" onclick="toggleDetails(this)">
                        <div class="flex justify-between items-start mb-2">
                            <h3 class="font-bold text-gray-800">Wed 04: Seaside Vibe</h3>
                            <div class="flex items-center gap-2">
                                <span class="pass-badge-pay text-xs px-2 py-1 rounded-full font-bold">IC Card</span>
                                <i class="fas fa-chevron-down text-gray-400 chevron-icon"></i>
                            </div>
                        </div>
                        <p class="text-gray-600 text-sm mb-2">üåä ‡∏ô‡∏±‡πà‡∏á‡∏£‡∏ñ‡πÑ‡∏ü‡πÑ‡∏õ‡πÑ‡∏´‡∏ß‡πâ‡∏û‡∏£‡∏∞‡πÉ‡∏´‡∏ç‡πà‡∏£‡∏¥‡∏°‡∏ó‡∏∞‡πÄ‡∏• & ‡πÇ‡∏¢‡πÇ‡∏Å‡∏Æ‡∏≤‡∏°‡πà‡∏≤</p>
                        <div class="flex gap-2 flex-wrap">
                            <span class="bg-white text-purple-600 text-xs px-2 py-1 rounded shadow-sm border border-purple-50">üìçKamakura</span>
                            <span class="bg-white text-purple-600 text-xs px-2 py-1 rounded shadow-sm border border-purple-50">üìçYokohama</span>
                        </div>

                        <!-- Hidden Details -->
                        <div class="details-content text-sm text-gray-700 space-y-2">
                            <div class="flex gap-3">
                                <span class="font-bold text-gray-600 w-12">09:00</span>
                                <div>‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡πÑ‡∏õ Kamakura (‡∏£‡∏ñ‡πÑ‡∏ü JR Yokosuka Line)</div>
                            </div>
                            <div class="flex gap-3">
                                <span class="font-bold text-gray-600 w-12">‡πÄ‡∏ä‡πâ‡∏≤</span>
                                <div>‡πÑ‡∏´‡∏ß‡πâ‡∏û‡∏£‡∏∞‡πÉ‡∏´‡∏ç‡πà <b>Kamakura Daibutsu</b>, ‡∏ß‡∏±‡∏î Hase-dera</div>
                            </div>
                            <div class="flex gap-3">
                                <span class="font-bold text-gray-600 w-12">‡∏ö‡πà‡∏≤‡∏¢</span>
                                <div>‡∏ô‡∏±‡πà‡∏á‡∏£‡∏ñ‡πÑ‡∏ü Enoden ‡πÑ‡∏õ <b>Kamakurakokomae</b> (‡∏à‡∏∏‡∏î‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ Slam Dunk)</div>
                            </div>
                            <div class="flex gap-3">
                                <span class="font-bold text-gray-600 w-12">‡πÄ‡∏¢‡πá‡∏ô</span>
                                <div>‡πÅ‡∏ß‡∏∞ <b>Yokohama:</b> ‡πÄ‡∏î‡∏¥‡∏ô‡πÄ‡∏•‡πà‡∏ô Minato Mirai, ‡πÇ‡∏Å‡∏î‡∏±‡∏á‡∏≠‡∏¥‡∏ê‡πÅ‡∏î‡∏á, Chinatown</div>
                            </div>
                            <div class="bg-white p-2 rounded border border-gray-200 mt-2 text-xs">
                                <i class="fas fa-train text-gray-500"></i> <b>‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á:</b> ‡πÉ‡∏ä‡πâ‡∏ö‡∏±‡∏ï‡∏£ IC Card ‡∏à‡πà‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß ‡∏´‡∏£‡∏∑‡∏≠ Enoshima Pass
                            </div>
                             <button onclick="event.stopPropagation(); askGemini('‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏à‡∏∏‡∏î‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ‡∏™‡∏ß‡∏¢‡πÜ ‡πÉ‡∏ô Kamakura')" class="mt-2 text-purple-500 hover:text-purple-700 text-xs font-bold flex items-center gap-1">
                                <i class="fas fa-sparkles"></i> ‡∏ñ‡∏≤‡∏°‡∏à‡∏∏‡∏î‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ Kamakura
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- SECTION 3: JR WIDE PASS (HIGHLIGHT) -->
            <div class="bg-green-50 rounded-2xl p-5 border-2 border-green-200 relative mt-6 shadow-inner">
                <div class="absolute -top-4 left-1/2 transform -translate-x-1/2 bg-green-500 text-white text-xs font-bold px-4 py-1 rounded-full shadow-lg border-2 border-white">
                    üöÑ JR Tokyo Wide Pass Zone (Thu-Sat)
                </div>

                <!-- Day 4 -->
                <div class="flex gap-4 mb-6 mt-4 items-start cursor-pointer group" onclick="toggleDetails(this)">
                    <div class="day-circle bg-white text-green-600 border-2 border-green-100 shrink-0">4</div>
                    <div class="w-full">
                        <div class="flex justify-between items-center">
                            <h3 class="font-bold text-green-900">Thu 05: Snow Fun ‚ùÑÔ∏è</h3>
                            <i class="fas fa-chevron-down text-green-600 chevron-icon"></i>
                        </div>
                        <p class="text-sm text-gray-600">‡∏ô‡∏±‡πà‡∏á Shinkansen ‡πÑ‡∏õ‡πÄ‡∏•‡πà‡∏ô‡∏´‡∏¥‡∏°‡∏∞‡∏ó‡∏µ‡πà <b>Gala Yuzawa</b></p>
                        
                        <!-- Hidden Details -->
                         <div class="details-content text-sm text-gray-700 space-y-2">
                            <div class="flex gap-3">
                                <span class="font-bold text-green-600 w-12">08:00</span>
                                <div>‡∏Ç‡∏∂‡πâ‡∏ô <b>Joetsu Shinkansen</b> (Tokyo -> Gala Yuzawa) *‡∏ï‡πâ‡∏≠‡∏á‡∏à‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á</div>
                            </div>
                            <div class="flex gap-3">
                                <span class="font-bold text-green-600 w-12">10:00</span>
                                <div>‡∏ñ‡∏∂‡∏á‡∏•‡∏≤‡∏ô‡∏™‡∏Å‡∏µ ‡πÄ‡∏ä‡πà‡∏≤‡∏ä‡∏∏‡∏î/‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå ‡πÄ‡∏•‡πà‡∏ô‡∏ñ‡∏≤‡∏î‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡∏™‡∏Å‡∏µ</div>
                            </div>
                            <div class="flex gap-3">
                                <span class="font-bold text-green-600 w-12">16:00</span>
                                <div>‡∏ô‡∏±‡πà‡∏á Shinkansen ‡∏Å‡∏•‡∏±‡∏ö‡πÇ‡∏ï‡πÄ‡∏Å‡∏µ‡∏¢‡∏ß</div>
                            </div>
                            <div class="flex gap-3">
                                <span class="font-bold text-green-600 w-12">‡πÄ‡∏¢‡πá‡∏ô</span>
                                <div>‡∏ó‡∏≤‡∏ô‡∏°‡∏∑‡πâ‡∏≠‡πÄ‡∏¢‡πá‡∏ô‡∏≠‡∏∏‡πà‡∏ô‡πÜ (Yakiniku ‡∏´‡∏£‡∏∑‡∏≠ Shabu) ‡πÉ‡∏ô‡πÇ‡∏ï‡πÄ‡∏Å‡∏µ‡∏¢‡∏ß</div>
                            </div>
                             <button onclick="event.stopPropagation(); askGemini('‡πÄ‡∏ä‡πà‡∏≤‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà Gala Yuzawa ‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏ó‡πà‡∏≤‡πÑ‡∏´‡∏£‡πà')" class="mt-2 text-green-600 hover:text-green-800 text-xs font-bold flex items-center gap-1">
                                <i class="fas fa-sparkles"></i> ‡∏ñ‡∏≤‡∏°‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏ä‡πà‡∏≤‡∏ä‡∏∏‡∏î‡∏™‡∏Å‡∏µ
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Day 5 -->
                <div class="flex gap-4 mb-6 items-start cursor-pointer group" onclick="toggleDetails(this)">
                    <div class="day-circle bg-white text-green-600 border-2 border-green-100 shrink-0">5</div>
                    <div class="w-full">
                        <div class="flex justify-between items-center">
                            <h3 class="font-bold text-green-900">Fri 06: Shopping & Anime üõçÔ∏è</h3>
                             <i class="fas fa-chevron-down text-green-600 chevron-icon"></i>
                        </div>
                        <p class="text-sm text-gray-600">‡∏ô‡∏±‡πà‡∏á Shinkansen ‡πÑ‡∏õ <b>Karuizawa</b> ‡πÄ‡∏¢‡πá‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÄ‡∏î‡∏¥‡∏ô <b>Akihabara</b></p>

                        <!-- Hidden Details -->
                        <div class="details-content text-sm text-gray-700 space-y-2">
                             <div class="flex gap-3">
                                <span class="font-bold text-green-600 w-12">09:00</span>
                                <div>‡∏Ç‡∏∂‡πâ‡∏ô <b>Hokuriku Shinkansen</b> (Tokyo -> Karuizawa)</div>
                            </div>
                            <div class="flex gap-3">
                                <span class="font-bold text-green-600 w-12">‡πÄ‡∏ä‡πâ‡∏≤</span>
                                <div>‡πÄ‡∏î‡∏¥‡∏ô‡πÄ‡∏•‡πà‡∏ô Kyu-Karuizawa Ginza Street (‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡πÄ‡∏Å‡πà‡∏≤)</div>
                            </div>
                            <div class="flex gap-3">
                                <span class="font-bold text-green-600 w-12">‡∏ö‡πà‡∏≤‡∏¢</span>
                                <div>‡∏ä‡πâ‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á <b>Karuizawa Prince Shopping Plaza</b> (Outlet ‡∏ß‡∏¥‡∏ß‡∏™‡∏ß‡∏¢‡∏°‡∏≤‡∏Å)</div>
                            </div>
                            <div class="flex gap-3">
                                <span class="font-bold text-green-600 w-12">‡πÄ‡∏¢‡πá‡∏ô</span>
                                <div>‡∏Å‡∏•‡∏±‡∏ö‡πÇ‡∏ï‡πÄ‡∏Å‡∏µ‡∏¢‡∏ß -> ‡πÑ‡∏õ‡πÄ‡∏î‡∏¥‡∏ô‡∏¢‡πà‡∏≤‡∏ô <b>Akihabara</b> ‡∏î‡∏π‡πÇ‡∏°‡πÄ‡∏î‡∏•/‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡πÑ‡∏ü‡∏ü‡πâ‡∏≤</div>
                            </div>
                            <button onclick="event.stopPropagation(); askGemini('Karuizawa Outlet ‡∏°‡∏µ‡πÅ‡∏ö‡∏£‡∏ô‡∏î‡πå‡∏≠‡∏∞‡πÑ‡∏£‡∏ô‡πà‡∏≤‡∏™‡∏ô‡πÉ‡∏à‡∏ö‡πâ‡∏≤‡∏á')" class="mt-2 text-green-600 hover:text-green-800 text-xs font-bold flex items-center gap-1">
                                <i class="fas fa-sparkles"></i> ‡∏ñ‡∏≤‡∏°‡πÅ‡∏ö‡∏£‡∏ô‡∏î‡πå‡πÄ‡∏ô‡∏°‡∏ó‡∏µ‡πà Karuizawa
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Day 6 -->
                <div class="flex gap-4 items-start cursor-pointer group" onclick="toggleDetails(this)">
                    <div class="day-circle bg-white text-green-600 border-2 border-green-100 shrink-0">6</div>
                    <div class="w-full">
                        <div class="flex justify-between items-center">
                            <h3 class="font-bold text-green-900">Sat 07: Mt. Fuji Stay üóª</h3>
                             <i class="fas fa-chevron-down text-green-600 chevron-icon"></i>
                        </div>
                        <p class="text-sm text-gray-600">‡∏ô‡∏±‡πà‡∏á Fuji Excursion ‡∏¢‡∏¥‡∏á‡∏¢‡∏≤‡∏ß‡πÑ‡∏õ‡∏Ñ‡πâ‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô‡∏ó‡∏µ‡πà <b>Kawaguchiko</b></p>
                        
                        <!-- Hidden Details -->
                        <div class="details-content text-sm text-gray-700 space-y-2">
                             <div class="flex gap-3">
                                <span class="font-bold text-green-600 w-12">‡πÄ‡∏ä‡πâ‡∏≤</span>
                                <div>‡∏Ç‡∏∂‡πâ‡∏ô‡∏£‡∏ñ‡πÑ‡∏ü <b>Fuji Excursion</b> (Shinjuku -> Kawaguchiko) *‡∏à‡∏≠‡∏á‡∏¢‡∏≤‡∏Å ‡∏à‡∏≠‡∏á‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤!</div>
                            </div>
                            <div class="flex gap-3">
                                <span class="font-bold text-green-600 w-12">‡∏ö‡πà‡∏≤‡∏¢</span>
                                <div>‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß‡∏£‡∏≠‡∏ö‡∏ó‡∏∞‡πÄ‡∏•‡∏™‡∏≤‡∏ö: ‡πÄ‡∏à‡∏î‡∏µ‡∏¢‡πå‡πÅ‡∏î‡∏á Chureito Pagoda, Oishi Park, Music Forest</div>
                            </div>
                            <div class="flex gap-3">
                                <span class="font-bold text-green-600 w-12">‡∏Ñ‡πà‡∏≥</span>
                                <div>‡πÄ‡∏Ç‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏û‡∏±‡∏Å (Ryokan) ‡πÅ‡∏ä‡πà‡∏≠‡∏≠‡∏ô‡πÄ‡∏ã‡πá‡∏ô‡∏î‡∏π‡∏ß‡∏¥‡∏ß‡∏ü‡∏π‡∏à‡∏¥</div>
                            </div>
                            <div class="bg-white p-2 rounded border border-green-100 mt-2 text-xs">
                                <i class="fas fa-info-circle text-green-500"></i> ‡∏ß‡∏±‡∏ô‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á JR Wide Pass ‡πÉ‡∏ä‡πâ‡∏Ç‡∏≤‡πÑ‡∏õ‡∏Ñ‡∏∏‡πâ‡∏°‡πÅ‡∏•‡πâ‡∏ß
                            </div>
                             <button onclick="event.stopPropagation(); askGemini('‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏£‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏≠‡∏ô‡πÄ‡∏ã‡πá‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß‡∏ó‡∏µ‡πà Kawaguchiko')" class="mt-2 text-green-600 hover:text-green-800 text-xs font-bold flex items-center gap-1">
                                <i class="fas fa-sparkles"></i> ‡πÉ‡∏´‡πâ AI ‡∏ä‡πà‡∏ß‡∏¢‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏û‡∏±‡∏Å
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- SECTION 4: BUS & RETURN -->
            <div class="relative pl-6 border-l-2 border-dashed border-yellow-300 pt-4">
                 <!-- Day 7 -->
                <div class="mb-8 relative">
                    <div class="absolute -left-[2.3rem] top-0 day-circle bg-yellow-100 text-yellow-600 border-2 border-white">7</div>
                    <div class="bg-yellow-50 p-4 rounded-xl border border-yellow-200 hover:shadow-md transition-shadow cursor-pointer group" onclick="toggleDetails(this)">
                        <div class="flex justify-between items-start mb-2">
                            <h3 class="font-bold text-gray-800">Sun 08: Youth City</h3>
                            <div class="flex items-center gap-2">
                                <span class="bg-yellow-100 text-yellow-800 border border-yellow-300 text-xs px-2 py-1 rounded-full font-bold">Bus + IC</span>
                                <i class="fas fa-chevron-down text-yellow-600 chevron-icon"></i>
                            </div>
                        </div>
                        <p class="text-gray-600 text-sm mb-2">üöå ‡∏ô‡∏±‡πà‡∏á‡∏ö‡∏±‡∏™‡∏Å‡∏•‡∏±‡∏ö‡∏ä‡∏¥‡∏ô‡∏à‡∏π‡∏Å‡∏∏ -> ‡πÄ‡∏î‡∏¥‡∏ô‡∏¢‡πà‡∏≤‡∏ô‡∏ß‡∏±‡∏¢‡∏£‡∏∏‡πà‡∏ô</p>
                        <div class="flex gap-2 flex-wrap">
                            <span class="bg-white text-yellow-600 text-xs px-2 py-1 rounded shadow-sm border border-yellow-50">üìçShinjuku</span>
                            <span class="bg-white text-yellow-600 text-xs px-2 py-1 rounded shadow-sm border border-yellow-50">üìçHarajuku</span>
                            <span class="bg-white text-yellow-600 text-xs px-2 py-1 rounded shadow-sm border border-yellow-50">üìçShibuya</span>
                        </div>

                        <!-- Hidden Details -->
                        <div class="details-content text-sm text-gray-700 space-y-2">
                             <div class="flex gap-3">
                                <span class="font-bold text-yellow-700 w-12">‡πÄ‡∏ä‡πâ‡∏≤</span>
                                <div>‡πÄ‡∏î‡∏¥‡∏ô‡πÄ‡∏•‡πà‡∏ô‡∏£‡∏¥‡∏°‡∏ó‡∏∞‡πÄ‡∏•‡∏™‡∏≤‡∏ö‡∏ï‡∏≠‡∏ô‡πÄ‡∏ä‡πâ‡∏≤ / Check-out</div>
                            </div>
                            <div class="flex gap-3">
                                <span class="font-bold text-yellow-700 w-12">10:00</span>
                                <div>‡∏Ç‡∏∂‡πâ‡∏ô <b>Highway Bus</b> ‡∏Å‡∏•‡∏±‡∏ö Shinjuku (‡∏™‡∏∞‡∏î‡∏ß‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏£‡∏ñ‡πÑ‡∏ü‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏ö‡∏Å‡∏Ç‡∏≠‡∏á‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏≤‡∏¢)</div>
                            </div>
                            <div class="flex gap-3">
                                <span class="font-bold text-yellow-700 w-12">‡∏ö‡πà‡∏≤‡∏¢</span>
                                <div><b>Harajuku:</b> ‡∏®‡∏≤‡∏•‡πÄ‡∏à‡πâ‡∏≤ Meiji, ‡∏ñ‡∏ô‡∏ô Takeshita<br><b>Shibuya:</b> ‡∏´‡πâ‡∏≤‡πÅ‡∏¢‡∏Å, Shibuya Sky (‡∏à‡∏≠‡∏á‡∏£‡∏≠‡∏ö Sunset)</div>
                            </div>
                             <div class="bg-white p-2 rounded border border-yellow-200 mt-2 text-xs">
                                <i class="fas fa-bus text-yellow-600"></i> <b>‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á:</b> Highway Bus (2,200¬•) + IC Card
                            </div>
                        </div>
                    </div>
                </div>

                 <!-- Day 8 -->
                 <div class="relative">
                    <div class="absolute -left-[2.3rem] top-0 day-circle bg-gray-200 text-gray-600 border-2 border-white">8</div>
                    <div class="bg-gray-100 p-4 rounded-xl border border-gray-200 hover:shadow-md transition-shadow cursor-pointer group" onclick="toggleDetails(this)">
                        <div class="flex justify-between items-start mb-2">
                            <h3 class="font-bold text-gray-800">Mon 09: Bye Bye! üëã</h3>
                            <div class="flex items-center gap-2">
                                <span class="pass-badge-pay text-xs px-2 py-1 rounded-full font-bold">Keisei Train</span>
                                <i class="fas fa-chevron-down text-gray-500 chevron-icon"></i>
                            </div>
                        </div>
                        <p class="text-gray-600 text-sm mb-2">‡πÄ‡∏Å‡πá‡∏ö‡∏ï‡∏Å‡∏Ç‡∏≠‡∏á‡∏ù‡∏≤‡∏Å -> ‡πÑ‡∏õ‡∏™‡∏ô‡∏≤‡∏°‡∏ö‡∏¥‡∏ô</p>
                        <div class="bg-white text-red-500 border border-red-100 text-xs px-3 py-2 rounded-lg inline-block font-medium shadow-sm">
                            <i class="fas fa-plane mr-1"></i> Flight 17:35 (‡∏ñ‡∏∂‡∏á‡∏™‡∏ô‡∏≤‡∏°‡∏ö‡∏¥‡∏ô 15:30)
                        </div>

                        <!-- Hidden Details -->
                        <div class="details-content text-sm text-gray-700 space-y-2">
                             <div class="flex gap-3">
                                <span class="font-bold text-gray-600 w-12">‡πÄ‡∏ä‡πâ‡∏≤</span>
                                <div>‡∏ù‡∏≤‡∏Å‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤‡∏ó‡∏µ‡πà Locker / ‡πÄ‡∏Å‡πá‡∏ö‡∏ï‡∏Å‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≠‡∏á‡∏ù‡∏≤‡∏Å‡∏¢‡πà‡∏≤‡∏ô Ueno ‡∏´‡∏£‡∏∑‡∏≠ Shinjuku</div>
                            </div>
                            <div class="flex gap-3">
                                <span class="font-bold text-gray-600 w-12">13:30</span>
                                <div>‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡πÑ‡∏õ‡∏™‡∏ô‡∏≤‡∏°‡∏ö‡∏¥‡∏ô Narita (‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡πÄ‡∏ß‡∏•‡∏≤ 2-3 ‡∏ä‡∏°.)</div>
                            </div>
                             <div class="flex gap-3">
                                <span class="font-bold text-gray-600 w-12">15:30</span>
                                <div>‡∏ñ‡∏∂‡∏á‡∏™‡∏ô‡∏≤‡∏°‡∏ö‡∏¥‡∏ô Check-in / ‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏ô‡∏° Duty Free</div>
                            </div>
                             <div class="bg-white p-2 rounded border border-gray-300 mt-2 text-xs">
                                <i class="fas fa-train text-gray-500"></i> <b>‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á:</b> Keisei Skyliner ‡∏´‡∏£‡∏∑‡∏≠ Main Line (‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î)
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>

        <!-- Footer -->
        <div class="bg-gray-50 p-6 border-t border-gray-200 text-center">
            <h4 class="font-bold text-gray-700 mb-2"><i class="fas fa-piggy-bank text-pink-500 mr-2"></i>‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏Å‡∏≤‡∏£‡∏Ñ‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á</h4>
            <p class="text-3xl font-bold text-green-600">~26,000 ‡πÄ‡∏¢‡∏ô</p>
            <p class="text-xs text-gray-400 mt-1">(‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î‡∏Å‡∏ß‡πà‡∏≤‡∏ã‡∏∑‡πâ‡∏≠‡πÅ‡∏¢‡∏Å ~40%)</p>
        </div>

    </div>

    <div class="text-center text-gray-400 text-xs no-print mb-20">
        <p>Build with ‚ù§Ô∏è by Miickiie</p>
    </div>

    <!-- Floating AI Button -->
    <button onclick="toggleChat()" class="ai-float-btn no-print bg-gradient-to-r from-purple-600 to-indigo-600 text-white rounded-full p-4 shadow-2xl hover:scale-110 transition-transform duration-300 flex items-center gap-2 group">
        <i class="fas fa-sparkles text-xl group-hover:rotate-12 transition-transform"></i>
        <span class="font-bold pr-1 hidden group-hover:inline-block whitespace-nowrap transition-all">‡∏ñ‡∏≤‡∏° AI</span>
    </button>

    <!-- AI Chat Modal -->
    <div id="ai-modal" class="fixed inset-0 bg-black/50 z-[100] hidden flex items-end sm:items-center justify-center p-4 no-print backdrop-blur-sm">
        <div class="bg-white w-full max-w-md rounded-t-2xl sm:rounded-2xl shadow-2xl flex flex-col max-h-[80vh] overflow-hidden transform transition-all scale-95 opacity-0" id="ai-modal-content">
            
            <!-- Modal Header -->
            <div class="bg-gradient-to-r from-purple-600 to-indigo-600 p-4 text-white flex justify-between items-center shrink-0">
                <div class="flex items-center gap-2">
                    <i class="fas fa-robot"></i>
                    <h3 class="font-bold">Gemini Travel Assistant</h3>
                </div>
                <button onclick="toggleChat()" class="text-white/80 hover:text-white transition">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>

            <!-- Chat Area -->
            <div id="chat-history" class="flex-1 overflow-y-auto p-4 space-y-4 bg-gray-50 min-h-[300px]">
                <!-- Welcome Message -->
                <div class="flex items-start gap-3">
                    <div class="w-8 h-8 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-600 shrink-0">
                        <i class="fas fa-sparkles text-sm"></i>
                    </div>
                    <div class="bg-white p-3 rounded-2xl rounded-tl-none shadow-sm text-sm text-gray-700 border border-gray-100">
                        ‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö! ‡∏ú‡∏°‡∏Ñ‡∏∑‡∏≠ AI ‡∏ú‡∏π‡πâ‡∏ä‡πà‡∏ß‡∏¢‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß‡πÇ‡∏ï‡πÄ‡∏Å‡∏µ‡∏¢‡∏ß‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì üáØüáµ ‡∏°‡∏µ‡∏≠‡∏∞‡πÑ‡∏£‡πÉ‡∏´‡πâ‡∏ä‡πà‡∏ß‡∏¢‡πÑ‡∏´‡∏°‡∏Ñ‡∏£‡∏±‡∏ö? <br><br>
                        ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°:
                        <ul class="list-disc ml-4 mt-1 text-xs text-gray-500 space-y-1">
                            <li>"‡∏Ç‡∏≠‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏±‡πà‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏´‡∏ô‡πà‡∏≠‡∏¢"</li>
                            <li>"‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏£‡πâ‡∏≤‡∏ô‡∏Ç‡∏ô‡∏°‡πÉ‡∏ô Karuizawa"</li>
                            <li>"‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏´‡∏ô‡∏≤‡∏ß‡πÅ‡∏Ñ‡πà‡πÑ‡∏´‡∏ô"</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Input Area -->
            <div class="p-4 bg-white border-t border-gray-100 shrink-0">
                <div class="relative flex items-center">
                    <input type="text" id="user-input" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà..." class="w-full bg-gray-100 rounded-full py-3 pl-4 pr-12 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-all" onkeypress="handleKeyPress(event)">
                    <button onclick="sendMessage()" class="absolute right-2 bg-indigo-600 text-white w-8 h-8 rounded-full flex items-center justify-center hover:bg-indigo-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed" id="send-btn">
                        <i class="fas fa-paper-plane text-xs"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const apiKey = "AIzaSyCBCpl5xsJrKp9Yg60frZTXOMExH9-5tQQ"; // System provides API key

        // Toggle Details Logic
        function toggleDetails(card) {
            const content = card.querySelector('.details-content');
            
            // Close all other cards
            document.querySelectorAll('.details-content').forEach(el => {
                if (el !== content) {
                    el.classList.remove('open');
                    el.closest('.group').classList.remove('card-open');
                }
            });

            // Toggle current card
            content.classList.toggle('open');
            card.classList.toggle('card-open');
        }

        // Toggle Chat Modal
        function toggleChat() {
            const modal = document.getElementById('ai-modal');
            const content = document.getElementById('ai-modal-content');
            
            if (modal.classList.contains('hidden')) {
                modal.classList.remove('hidden');
                setTimeout(() => {
                    content.classList.remove('scale-95', 'opacity-0');
                    content.classList.add('scale-100', 'opacity-100');
                    document.getElementById('user-input').focus();
                }, 10);
            } else {
                content.classList.remove('scale-100', 'opacity-100');
                content.classList.add('scale-95', 'opacity-0');
                setTimeout(() => {
                    modal.classList.add('hidden');
                }, 300);
            }
        }

        // Handle Enter Key
        function handleKeyPress(event) {
            if (event.key === 'Enter') sendMessage();
        }

        // Helper to scroll to bottom
        function scrollToBottom() {
            const chatHistory = document.getElementById('chat-history');
            chatHistory.scrollTop = chatHistory.scrollHeight;
        }

        // Generate Response using Gemini
        async function callGeminiAPI(prompt) {
            const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
            
            const data = {
                contents: [{
                    parts: [{ text: prompt }]
                }]
            };

            try {
                const response = await fetch(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });

                if (!response.ok) throw new Error('API Error');
                
                const result = await response.json();
                return result.candidates[0].content.parts[0].text;
            } catch (error) {
                console.error('Error:', error);
                return "‡∏Ç‡∏≠‡∏≠‡∏†‡∏±‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö ‡∏£‡∏∞‡∏ö‡∏ö‡∏Ç‡∏±‡∏î‡∏Ç‡πâ‡∏≠‡∏á‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏†‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏á";
            }
        }

        // Add Message to UI
        function addMessage(text, isUser = false) {
            const history = document.getElementById('chat-history');
            const div = document.createElement('div');
            div.className = isUser ? 'flex items-end justify-end gap-2' : 'flex items-start gap-3';

            const avatar = isUser 
                ? `<div class="w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center text-gray-500 shrink-0 order-2"><i class="fas fa-user text-sm"></i></div>`
                : `<div class="w-8 h-8 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-600 shrink-0"><i class="fas fa-sparkles text-sm"></i></div>`;

            const bubbleClass = isUser 
                ? 'bg-indigo-600 text-white rounded-2xl rounded-tr-none shadow-md' 
                : 'bg-white text-gray-700 rounded-2xl rounded-tl-none shadow-sm border border-gray-100';

            // Parse Markdown for bot messages
            const contentHtml = isUser ? text : marked.parse(text);

            div.innerHTML = `
                ${avatar}
                <div class="${bubbleClass} p-3 text-sm max-w-[80%] prose prose-sm ${isUser ? 'prose-invert' : ''}">
                    ${contentHtml}
                </div>
            `;
            
            history.appendChild(div);
            scrollToBottom();
        }

        // Show Loading Indicator
        function showLoading() {
            const history = document.getElementById('chat-history');
            const div = document.createElement('div');
            div.id = 'loading-dots';
            div.className = 'flex items-start gap-3';
            div.innerHTML = `
                <div class="w-8 h-8 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-600 shrink-0"><i class="fas fa-sparkles text-sm"></i></div>
                <div class="bg-white p-4 rounded-2xl rounded-tl-none shadow-sm border border-gray-100 flex gap-1">
                    <div class="w-2 h-2 bg-indigo-400 rounded-full typing-dot"></div>
                    <div class="w-2 h-2 bg-indigo-400 rounded-full typing-dot"></div>
                    <div class="w-2 h-2 bg-indigo-400 rounded-full typing-dot"></div>
                </div>
            `;
            history.appendChild(div);
            scrollToBottom();
        }

        function removeLoading() {
            const loading = document.getElementById('loading-dots');
            if (loading) loading.remove();
        }

        // Main Send Logic
        async function sendMessage() {
            const input = document.getElementById('user-input');
            const text = input.value.trim();
            if (!text) return;

            input.value = '';
            input.disabled = true;
            document.getElementById('send-btn').disabled = true;

            addMessage(text, true);
            showLoading();

            const systemContext = "You are a helpful Tokyo travel assistant. The user is going on an 8-day trip to Tokyo, Kamakura, Gala Yuzawa, Karuizawa, and Kawaguchiko in early February. It is winter. Answer briefly, helpful, and in Thai language.";
            const response = await callGeminiAPI(`${systemContext}\n\nUser Question: ${text}`);

            removeLoading();
            addMessage(response, false);

            input.disabled = false;
            document.getElementById('send-btn').disabled = false;
            input.focus();
        }

        // Quick Action: Ask Gemini
        function askGemini(question) {
            toggleChat();
            const input = document.getElementById('user-input');
            input.value = question;
            sendMessage();
        }

        // Feature: Generate Packing List
        async function generatePackingList() {
            toggleChat();
            const input = document.getElementById('user-input');
            
            addMessage("‚ú® ‡∏ä‡πà‡∏ß‡∏¢‡∏à‡∏±‡∏î‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏£‡∏¥‡∏õ‡πÇ‡∏ï‡πÄ‡∏Å‡∏µ‡∏¢‡∏ß 8 ‡∏ß‡∏±‡∏ô‡πÉ‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå‡πÉ‡∏´‡πâ‡∏´‡∏ô‡πà‡∏≠‡∏¢", true);
            showLoading();

            const prompt = "Create a concise packing list for an 8-day trip to Tokyo, Gala Yuzawa (snow), and Kawaguchiko in early February. Format as a checklist using Markdown. Language: Thai.";
            const response = await callGeminiAPI(prompt);

            removeLoading();
            addMessage(response, false);
        }
    </script>
</body>
</html>
